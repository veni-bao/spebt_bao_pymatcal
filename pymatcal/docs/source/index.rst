.. pymatcal documentation master file, created by
   sphinx-quickstart on Wed Jul 17 13:48:51 2024.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

pymatcal documentation
======================
.. Add your content using ``reStructuredText`` syntax. See the reStructuredText
   https://www.sphinx-doc.org/en/master/usage/restructuredtext/index.html
   documentation for details.

=================
Introduction
=================
**pymatcal** is a Python implementation of the ray-tracing-based analytical calculation of system response matrix of a single photon emission tomography system. Key features of the project are:
- Almost 100% Numpy-based, transition to a CUDA capable system should be easy with Python packages like `CuPy <https://cupy.dev/>`_
- It is written in an MPI-ready style. With the help of `mpi4py <https://mpi4py.readthedocs.io/en/stable/>`_, we can run the calculation in parallel with a short Python script.
- System matrix I/O is handled with `h5py <https://docs.h5py.org/en/stable/>`_ package. The package provides a convenient API for writing data in parallel with MPI.


=================
Get Started 
=================
1. Install mpi4py 

2. Install HDF5 parallel version, check `h5py-paralell <https://docs.h5py.org/en/stable/mpi.html#>`_

3. Install h5py

4. Download the code

.. code-block::

   git https://github.com/spebt/pymatcal.git

5. Setup with ``pipenv``

.. code-block::

   cd pymatcal
   pipenv install && pipenv shell

6. Run the test

.. code-block::

   cd test
   mpiexe -n 4 python get_all_ppdfs_mpi.py test_20240722_182815.yml

=================
Example PPDF
=================
The following image shows the PPDFs of a single pinhole detector unit. The detector system consists of a single pinhole and a detector system. The image is generated by the `pymatcal` package.

.. image:: ./test_20240722_182815_data_det_000.png
   :alt: singe-pinhole-1-detetor-unit
   :width: 1024px
   :align: center

=================
Quick Start
================
sudo apt-get install openmpi-bin

.. toctree::
   :maxdepth: 2
   :caption: Contents:

   deps.md
   api-ref.md



